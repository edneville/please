.\" Automatically generated by Pandoc 2.2.1
.\"
.TH "PLEASE" "1" "16 August 2020" "please user manual" ""
.hy
.SH NAME
.PP
please.ini
.SH DESCRIPTION
.PP
The \f[C]please.ini\f[] file contains the ACL for users of the
\f[C]please\f[] and \f[C]pleaseedit\f[] programs.
.PP
All rules in \f[C]please.ini\f[] will permit or deny based on command
regex matches.
.PP
\f[C]please.ini\f[] is an ini file, and as such it makes sense to label
the sections with a good short description of what the section provides.
You may then find this helpful when listing rights with
\f[C]please\ \-l\f[].
.PP
Rules are read and applied in the order they are presented in the
configuration file.
So if the user is permitted to run a command early in the file, but
later a deny is matches against \f[C]\&.*\f[], then the user will not be
permitted to run any command.
.PP
\f[C]%{USER}\f[] will expand to the user who is currently running
\f[C]please\f[], this enables a single rule for a group to modify/run
something that matches their name.
.PP
The properties in ini permitted are as follows:
.IP \[bu] 2
name=[regex], or user, mandatory
.IP \[bu] 2
target=[regex] user to execute or list as, defaults to root
.IP \[bu] 2
permit=[true|false] defaults to true
.IP \[bu] 2
require_pass=[true|false], defaults to true
.IP \[bu] 2
regex=[regex], is the regular expression that the command matches
against, defaults to ^$
.IP \[bu] 2
notbefore=[YYYYmmdd|YYYYmmddHHMMSS], defaults to never
.IP \[bu] 2
notafter=[YYYYmmdd|YYYYmmddHHMMSS], defaults to never
.IP \[bu] 2
datematch=[Day dd Mon HH:MM:SS UTC YYYY], regex to match against a date
string
.IP \[bu] 2
type=[edit/run/list], defaults to run, edit = pleaseedit entry, list =
user access rights listing
.IP \[bu] 2
group=[true|false] user, when true name refers to a group rather than a
user
.IP \[bu] 2
hostname=[regex], permitted hostnames where this may apply
.IP \[bu] 2
dir=[regex], permitted regex for switchable directories
.IP \[bu] 2
include=[file], read ini file, and continue to next section
.IP \[bu] 2
includedir=[directory], read .ini files in directory, and continue to
next section
.IP \[bu] 2
editcmd=[program], run program after editor exits, if exit is zero,
continue with file replacement
.IP \[bu] 2
editmode=[octal mode], set replacement file to octal mode
.PP
\f[C]regex\f[] is a regular expression.
.PP
Using an anchor (\f[C]^\f[]) for the regex field will be as good as
saying the rule should match any command.
.PP
If you wish to permit a user to view another's command set, then you may
do this using \f[C]type=list\f[] (run by default).
To list another user, they must match the \f[C]target\f[] regex.
.SH EXAMPLE
.PP
User \f[C]ed\f[] may only start or stop a docker container:
.IP
.nf
\f[C]
[user_ed_root]
name=ed
target=root
permit=true
regex=^/usr/bin/docker\ (start|stop)\ \\S+
\f[]
.fi
.PP
User \f[C]ben\f[] may only edit \f[C]/etc/fstab\f[]:
.IP
.nf
\f[C]
[ben_fstab]
name=ben
target=root
permit=true
type=edit
regex=^/etc/fstab$
\f[]
.fi
.PP
User \f[C]ben\f[] may list only users \f[C]eng\f[], \f[C]net\f[] and
\f[C]dba\f[] operators:
.IP
.nf
\f[C]
[ben_ops]
name=ben
permit=true
list=true
target=^(eng|net|dba)ops$
\f[]
.fi
.SH DATED RANGES
.PP
For large environments it is not unusual for a third party to require
access during a short time frame for debugging.
To accommodate this there are the \f[C]notbefore\f[] and
\f[C]notafter\f[] time brackets.
These can be either \f[C]YYYYmmdd\f[] or \f[C]YYYYMMDDHHMMSS\f[].
.PP
The whole day is considered when using the shorter date form of
\f[C]YYYYMMDD\f[].
.PP
Many enterprises may wish to permit access to a user for a limited time
only, even if that individual is in the role permanently.
.PP
User joker can do what they want as root on \f[C]1st\ April\ 2021\f[]:
.IP
.nf
\f[C]
[joker_april_first]
name=joker
target=root
permit=true
notbefore=20210401
notafter=20210401
regex=^/bin/bash
\f[]
.fi
.SH DATEMATCHES
.PP
Another date type is the \f[C]datematch\f[] item, this constrains
sections to a regex match against the date string
\f[C]Day\ dd\ mon\ HH:MM:SS\ UTC\ Year\f[].
.PP
You can permit some a group of users to perform some house keeping on a
Monday:
.IP
.nf
\f[C]
[l2_housekeeping]
name=l2users
group=true
target=root
permit=true
regex\ =\ /usr/local/housekeeping/.*
datematch\ =\ ^Thu\\\\s+1\\\\s+Oct\\\\s+22:00:00\\\\s+UTC\\\\s+2020
\f[]
.fi
.SH FILES
.PP
/etc/please.ini
.SH CONTRIBUTIONS
.PP
I welcome pull requests with open arms.
.SH AUTHORS
Ed Neville (ed\-please\@s5h.net).
